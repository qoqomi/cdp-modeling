# CDP Modeling AI Worker

> **CDP/ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì—°ë„Â·ë¬¸í•­Â·ê·¼ê±° ë¬¸ì„œë¥¼ ì •í™•íˆ ì¶”ì í•˜ì—¬ ì‹ ë¢° ê°€ëŠ¥í•œ AI ë‹µë³€ì„ ìƒì„±í•˜ëŠ” Retrieval-Augmented Generation(RAG) ì‹œìŠ¤í…œ**

CDP(Carbon Disclosure Project) ì§ˆë¬¸ì§€ ì‘ë‹µ ìë™í™”ë¥¼ ìœ„í•´ ì„¤ê³„ëœ ë³¸ ì‹œìŠ¤í…œì€, ë‹¨ìˆœ LLM ìƒì„±ì´ ì•„ë‹Œ **ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ê²€ìƒ‰ + ì—­í•  ëª…ì‹œ í”„ë¡¬í”„íŒ…**ì„ í†µí•´ ê·¼ê±° ìˆëŠ” ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

---

## 1. ë¬¸ì œ ì •ì˜ (Problem Statement)

### ì™œ ê·¸ëƒ¥ LLMì´ ì•„ë‹Œê°€?

ê¸°ì¡´ LLM ê¸°ë°˜ ë‹µë³€ ìƒì„±ì€ CDP ë„ë©”ì¸ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì¹˜ëª…ì  í•œê³„ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

| ë¬¸ì œ | ì„¤ëª… |
|------|------|
| **Hallucination** | ê³¼ê±° ì—°ë„(2023) ë°ì´í„°ì™€ í˜„ì¬ ì—°ë„(2025) ë°ì´í„°ê°€ í˜¼í•©ë˜ì–´ ì‚¬ì‹¤ê³¼ ë‹¤ë¥¸ ìˆ˜ì¹˜ ìƒì„± |
| **ë¬¸í•­ ìš”êµ¬ì‚¬í•­ ë¬´ì‹œ** | CDPì˜ `Requested Content`, `Scoring Criteria`ë¥¼ ë¬´ì‹œí•œ ì¼ë°˜ë¡ ì  ë‹µë³€ |
| **ê·¼ê±° ë¶€ì¬** | ë‹µë³€ì˜ ì¶œì²˜ë¥¼ ëª…í™•íˆ ì œì‹œí•  ìˆ˜ ì—†ì–´ ê°ì‚¬(Audit) ëŒ€ì‘ ë¶ˆê°€ |
| **ì—°ë„ í˜¼ë™** | "In 2023, we achieved..." ê°™ì€ ê³¼ê±° í‘œí˜„ì´ í˜„ì¬ ì‘ë‹µì— ê·¸ëŒ€ë¡œ ë³µì‚¬ |

ğŸ‘‰ **RAGëŠ” ì„ íƒì´ ì•„ë‹Œ í•„ì—°ì…ë‹ˆë‹¤.**

CDP ì‘ë‹µì€ ë§¤ë…„ ì œì¶œë˜ë©°, ê° ì—°ë„ë³„ ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œì˜ **ì •í™•í•œ ìˆ˜ì¹˜ì™€ ì •ì±…**ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ê³¼ê±° CDP ì‘ë‹µì€ **í˜•ì‹ ì°¸ê³ ìš©**ì¼ ë¿, ì‚¬ì‹¤ì˜ ê·¼ê±°ê°€ ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

---

## 2. í•´ê²° ì „ëµ (Why RAG?)

ë³¸ ì‹œìŠ¤í…œì€ **3-Layer Architecture**ë¥¼ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     3-Layer Architecture                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 1: RAG Layer                                          â”‚
â”‚  â†’ ì—°ë„Â·ë¬¸í•­Â·ë¬¸ì„œìœ í˜• ê¸°ë°˜ Metadata Filtering                  â”‚
â”‚  â†’ Dense Vector Search + Reranking                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: Mapping Layer                                      â”‚
â”‚  â†’ ì—°ë„ë³„ ì§ˆë¬¸ ì½”ë“œ ë§¤í•‘ (2025 Q2.1 â†’ 2024 Q2.1)              â”‚
â”‚  â†’ ìœ ì‚¬ë„ ê²€ìƒ‰ë§Œìœ¼ë¡œ ë¬¸í•­ ë§¤ì¹­ ê¸ˆì§€ (Rule-based)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3: Prompt Layer                                       â”‚
â”‚  â†’ ê³¼ê±° ë‹µë³€ = "REFERENCE ONLY" ëª…ì‹œ                         â”‚
â”‚  â†’ í˜„ì¬ ë³´ê³ ì„œ = "PRIMARY SOURCE" ëª…ì‹œ                       â”‚
â”‚  â†’ ì—°ë„ í‘œí˜„ ì œê±° ì§€ì‹œ ("In 2023" â†’ "Currently")              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ì„¤ê³„ ì›ì¹™

```python
# âŒ ê¸ˆì§€ ì‚¬í•­
- ì—°ë„ ë©”íƒ€ë°ì´í„° ì—†ì´ ë²¡í„° ê²€ìƒ‰ ê¸ˆì§€
- ìœ ì‚¬ë„ë§Œìœ¼ë¡œ ë¬¸í•­ ë§¤ì¹­ ê¸ˆì§€ (Mapping Layer í•„ìˆ˜)
- ê³¼ê±° ë‹µë³€ì„ ì •ë‹µì²˜ëŸ¼ ê·¸ëŒ€ë¡œ ë³µì‚¬ ê¸ˆì§€
- "ê´€ë ¨ ë¬¸ì„œë¥¼ ì°¸ê³ í•´ì„œ ë‹µë³€í•´ì¤˜" ê°™ì€ ëª¨í˜¸í•œ í”„ë¡¬í”„íŠ¸ ê¸ˆì§€

# âœ… í•„ìˆ˜ ì‚¬í•­
- ëª¨ë“  ê²€ìƒ‰ì— source_type, year í•„í„° ì ìš©
- ê³¼ê±° CDP ë‹µë³€ ê²€ìƒ‰ ì‹œ question_code í•„í„° í•„ìˆ˜
- í”„ë¡¬í”„íŠ¸ì—ì„œ ì—­í• (ì°¸ê³ ìš© vs ì‚¬ì‹¤ê¸°ë°˜) ëª…ì‹œ
```

---

## 3. ì „ì²´ ì•„í‚¤í…ì²˜ (Architecture Overview)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              User Request                                 â”‚
â”‚                    POST /ai/v1/generate/answer                           â”‚
â”‚                         { question_id: "2.1" }                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Layer 2: Mapping Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  QuestionMapper.get_historical_codes("2.1")                         â”‚  â”‚
â”‚  â”‚  â†’ ["2.1", "2.1.old"]  (2024ë…„ ëŒ€ì‘ ì§ˆë¬¸ ì½”ë“œ)                       â”‚  â”‚
â”‚  â”‚  â†’ mapping_confidence: "high" | "medium" | "low"                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Layer 1: RAG Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Historical CDP Answers        â”‚  â”‚   Sustainability Report        â”‚ â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚
â”‚  â”‚   source_type: CDP_ANSWER       â”‚  â”‚   source_type: SUSTAINABILITY  â”‚ â”‚
â”‚  â”‚   year: [2024]                  â”‚  â”‚   year: [2025]                 â”‚ â”‚
â”‚  â”‚   question_codes: ["2.1"]       â”‚  â”‚   (no question filter)         â”‚ â”‚
â”‚  â”‚   top_k: 3                      â”‚  â”‚   top_k: 5                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                            â”‚                    â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                        â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    BGE Reranker (ì™¸ë¶€ ì„œë¹„ìŠ¤ /rerank í˜¸ì¶œ)           â”‚  â”‚
â”‚  â”‚                    â†’ ë¬¸í•­ ì í•©ë„ ê¸°ì¤€ ì¬ì •ë ¬                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Layer 3: Prompt Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  System: "You are a CDP disclosure expert"                          â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  âš ï¸ HISTORICAL REFERENCE (ì°¸ê³ ìš© - ê·¸ëŒ€ë¡œ ì‚¬ìš© ê¸ˆì§€!)                â”‚  â”‚
â”‚  â”‚  [2024 CDP Answer for Q2.1]                                         â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  âœ… CURRENT DATA SOURCE (ì‚¬ì‹¤ ê¸°ë°˜)                                  â”‚  â”‚
â”‚  â”‚  [2025 Sustainability Report, Page 45-47]                           â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  Question Schema: columns, row_labels, options                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OpenAI GPT-4o-mini                                 â”‚
â”‚                    temperature: 0.2 (ì¼ê´€ì„± ì¤‘ì‹œ)                         â”‚
â”‚                    response_format: JSON                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Response                                         â”‚
â”‚  {                                                                        â”‚
â”‚    "rows": [{ "time_horizon": "Short-term", "from_years": 0, ... }],     â”‚
â”‚    "sources": [                                                           â”‚
â”‚      { "type": "sustainability_report", "year": 2025, "page": 45 },      â”‚
â”‚      { "type": "cdp_historical", "year": 2024, "note": "Reference only" }â”‚
â”‚    ],                                                                     â”‚
â”‚    "confidence": 0.85,                                                    â”‚
â”‚    "rationale_en": "Based on the 2025 report...",                        â”‚
â”‚    "rationale_ko": "2025ë…„ ë³´ê³ ì„œì— ë”°ë¥´ë©´..."                            â”‚
â”‚  }                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ë°ì´í„° ì„¤ê³„ (Data & Schema Design)

### RAG Document Schema

```python
@dataclass
class RAGDocument:
    # í•„ìˆ˜ í•„ë“œ
    text: str                      # ë¬¸ì„œ ë‚´ìš©
    source_type: SourceType        # CDP_ANSWER | SUSTAINABILITY_REPORT
    year: int                      # ì—°ë„ (2024, 2025)

    # CDP ë‹µë³€ ì „ìš© (source_type=CDP_ANSWERì¼ ë•Œ í•„ìˆ˜)
    question_code: Optional[str]   # "2.1", "2.2a"
    module: Optional[str]          # "C2", "C3"

    # ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ ì „ìš©
    section: Optional[str]         # "emissions", "governance", "strategy"
    page_num: Optional[int]        # í˜ì´ì§€ ë²ˆí˜¸
    chunk_id: Optional[str]        # ì²­í¬ ID

    # ê²€ìƒ‰ ë©”íƒ€
    score: float = 0.0             # ê²€ìƒ‰ ì ìˆ˜
    historical: bool = False       # ê³¼ê±° ë°ì´í„° ì—¬ë¶€
```

### Question Schema (CDP ë¬¸í•­ êµ¬ì¡°)

```json
{
  "question_id": "2.1",
  "title": "Describe your organization's process for identifying climate risks",
  "rationale": "CDP seeks to understand how organizations identify risks...",
  "requested_content": [
    "Time horizons covered",
    "Risk assessment methodology",
    "Integration with enterprise risk management"
  ],
  "columns": [
    { "id": "time_horizon", "type": "select", "options": ["Short-term", "Medium-term", "Long-term"] },
    { "id": "from_years", "type": "number" },
    { "id": "to_years", "type": "number" },
    { "id": "description", "type": "textarea" }
  ],
  "row_labels": ["Short-term", "Medium-term", "Long-term"]
}
```

### Sustainability Report Chunking

```python
class SustainabilityReportChunker:
    SECTION_KEYWORDS = {
        "governance": ["board", "committee", "oversight", "ì´ì‚¬íšŒ"],
        "strategy": ["roadmap", "target", "net zero", "ì „ëµ"],
        "emissions": ["scope 1", "scope 2", "ghg", "ë°°ì¶œ"],
        "energy": ["renewable", "consumption", "ì—ë„ˆì§€"],
        # ...
    }

    # ì²­í‚¹ ì„¤ì •
    chunk_size = 800        # ë¬¸ì
    chunk_overlap = 200     # ì˜¤ë²„ë©
    min_chunk_size = 100    # ìµœì†Œ í¬ê¸°
```

---

## 5. Retrieval ì „ëµ ìƒì„¸

### ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ì„± ìš”ì†Œ | ê¸°ìˆ  | ì„¤ëª… |
|----------|------|------|
| Embedding | BGE-M3 | 1024ì°¨ì›, ë‹¤êµ­ì–´ ì§€ì› |
| Vector DB | Qdrant | ë¡œì»¬ íŒŒì¼ ê¸°ë°˜, Cosine Similarity |
| Reranker | BGE Cross-Encoder | ì™¸ë¶€ ì„œë¹„ìŠ¤ í˜¸ì¶œ |
| Search | Dense Vector + Metadata Filter | ì˜ë¯¸ ê²€ìƒ‰ + ë©”íƒ€ë°ì´í„° í•„í„°ë§ |

### ì ìš©ëœ RAG ê¸°ë²• ì •ë¦¬

| ë‹¨ê³„ | ê¸°ë²• | ì ìš© | ì„¤ëª… |
|------|------|:----:|------|
| **Pre-retrieval** | Query Mapping | âœ… | ì—°ë„/ë¬¸í•­ ì½”ë“œ ë§¤í•‘ (Mapping Layer) |
| **Pre-retrieval** | Query Expansion | âŒ | ë¯¸ì ìš© |
| **Retrieval** | Dense Search | âœ… | BGE-M3 ì„ë² ë”© ê¸°ë°˜ ì˜ë¯¸ ê²€ìƒ‰ |
| **Retrieval** | Metadata Filtering | âœ… | `source_type`, `year`, `question_code` í•„í„° |
| **Retrieval** | Hybrid Search | âŒ | Denseë§Œ ì‚¬ìš© (Sparse ë¯¸ì ìš©) |
| **Post-retrieval** | Reranking | âœ… | ì™¸ë¶€ BGE ì„œë¹„ìŠ¤ `/rerank` ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ |
| **Post-retrieval** | Compression | âŒ | ë¯¸ì ìš© |

### Retrieval ë²”ìœ„ ë° Fallback ì „ëµ

#### ê²€ìƒ‰ ë²”ìœ„ (top_k)

| ê²€ìƒ‰ ëŒ€ìƒ | top_k | fetch_k (ë¦¬ë­í‚¹ìš©) | ì„¤ëª… |
|----------|:-----:|:-----------------:|------|
| **ê³¼ê±° CDP ë‹µë³€** | 3 | 9 (top_k Ã— 3) | í˜•ì‹/êµ¬ì¡° ì°¸ê³ ìš© |
| **ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ** | 5 | 15 (top_k Ã— 3) | ì‚¬ì‹¤ ê¸°ë°˜ ì£¼ ë°ì´í„° |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Retrieval Pipeline                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Dense Vector Search                                     â”‚
â”‚          â†’ fetch_k = top_k Ã— 3 (ë¦¬ë­í‚¹ì„ ìœ„í•´ ë” ë§ì´ ê°€ì ¸ì˜´)      â”‚
â”‚          â†’ CDP ë‹µë³€: 9ê°œ / ë³´ê³ ì„œ: 15ê°œ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 2: Reranking (ì™¸ë¶€ BGE ì„œë¹„ìŠ¤)                              â”‚
â”‚          â†’ ë¬¸í•­ ì í•©ë„ ê¸°ì¤€ ì¬ì •ë ¬                                 â”‚
â”‚          â†’ ìƒìœ„ top_kê°œë§Œ ì„ íƒ                                    â”‚
â”‚          â†’ CDP ë‹µë³€: 3ê°œ / ë³´ê³ ì„œ: 5ê°œ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 3: LLM Context                                             â”‚
â”‚          â†’ ìµœì¢… 8ê°œ ë¬¸ì„œê°€ í”„ë¡¬í”„íŠ¸ì— í¬í•¨                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Fallback ì „ëµ (ë¬¸ì œ ë°œìƒ ì‹œ)

| ìƒí™© | Fallback ë™ì‘ | ê²°ê³¼ |
|------|--------------|------|
| **Qdrant ë¯¸ì´ˆê¸°í™”** | ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ | LLMì´ ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ìœ¼ë¡œë§Œ ë‹µë³€ ìƒì„± |
| **Embedding ì„œë¹„ìŠ¤ ì¥ì• ** | ê²€ìƒ‰ ìŠ¤í‚µ | ë¹ˆ ì»¨í…ìŠ¤íŠ¸ë¡œ ì§„í–‰ |
| **CDP ë‹µë³€ ê²€ìƒ‰ ì‹¤íŒ¨** | `historical_answers = []` | í˜„ì¬ ë³´ê³ ì„œë§Œìœ¼ë¡œ ë‹µë³€ ìƒì„± |
| **ë³´ê³ ì„œ ê²€ìƒ‰ ì‹¤íŒ¨** | `current_context = []` | CDP ê°€ì´ë“œë¼ì¸ ê¸°ë°˜ ë‹µë³€ ìƒì„± |
| **Reranking ì‹¤íŒ¨** | ì›ë³¸ ìˆœì„œ ìœ ì§€ | Dense Search ê²°ê³¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© |
| **LLM API ì¥ì• ** | Soft Fallback | RAG ì»¨í…ìŠ¤íŠ¸ë§Œ ë°˜í™˜ (confidence: 0.0) |

```python
# cdp_generator.py - Fallback ë¡œì§
historical_answers = []
if historical_codes and historical_years:
    try:
        historical_answers = self.rag.search_cdp_answers(...)
    except Exception as e:
        print(f"ê³¼ê±° CDP ë‹µë³€ ê²€ìƒ‰ ì‹¤íŒ¨: {e}")
        # historical_answersëŠ” ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ìœ ì§€ â†’ ê³„ì† ì§„í–‰

current_context = []
try:
    current_context = self.rag.search_sustainability_report(...)
except Exception as e:
    print(f"ì§€ì†ê°€ëŠ¥ê²½ì˜ë³´ê³ ì„œ ê²€ìƒ‰ ì‹¤íŒ¨: {e}")
    # current_contextëŠ” ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ìœ ì§€ â†’ ê³„ì† ì§„í–‰

# ë‘˜ ë‹¤ ì‹¤íŒ¨í•´ë„ LLM í˜¸ì¶œì€ ì§„í–‰ (ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ë‹µë³€ ìƒì„±)
```

#### ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ ì‹ ë¢°ë„ ì˜í–¥

```python
def calculate_confidence(has_historical, rag_scores, mapping_confidence):
    base_score = 0.4  # ê¸°ë³¸ ì ìˆ˜

    # rag_scoresê°€ ë¹„ì–´ìˆìœ¼ë©´ RAG ê°€ì¤‘ì¹˜(50%) ë°˜ì˜ ì•ˆ ë¨
    if rag_scores:
        base_score += (avg_score) * 0.5

    # ê³¼ê±° ë‹µë³€ ì—†ìœ¼ë©´ 10% ê°€ì¤‘ì¹˜ ë°˜ì˜ ì•ˆ ë¨
    if has_historical:
        base_score += 0.1
```

| ê²€ìƒ‰ ìƒíƒœ | ì˜ˆìƒ ì‹ ë¢°ë„ |
|----------|:---------:|
| ëª¨ë‘ ì„±ê³µ (ë³´ê³ ì„œ + CDP) | 0.75 ~ 0.95 |
| ë³´ê³ ì„œë§Œ ì„±ê³µ | 0.65 ~ 0.85 |
| CDPë§Œ ì„±ê³µ | 0.40 ~ 0.50 |
| ëª¨ë‘ ì‹¤íŒ¨ | 0.40 (ê¸°ë³¸ê°’) |

### ê²€ìƒ‰ ì½”ë“œ ì˜ˆì‹œ

```python
# retriever.py
def search_cdp_answers(self, query, years, question_codes, top_k=3):
    """ê³¼ê±° CDP ë‹µë³€ ê²€ìƒ‰ - Mapping Layer ê²°ê³¼ ì‚¬ìš© í•„ìˆ˜"""
    return self.search(
        query=query,
        source_types=[SourceType.CDP_ANSWER],
        years=years,              # Mappingì—ì„œ ë°›ì€ ì—°ë„ [2024]
        question_codes=question_codes,  # Mappingì—ì„œ ë°›ì€ ì½”ë“œ ["2.1"]
        top_k=top_k,
        use_rerank=True,
    )

def search_sustainability_report(self, query, year, top_k=5):
    """í˜„ì¬ ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ ê²€ìƒ‰"""
    return self.search(
        query=query,
        source_types=[SourceType.SUSTAINABILITY_REPORT],
        years=[year],             # í˜„ì¬ ì—°ë„ [2025]
        top_k=top_k,
        use_rerank=True,
    )
```

---

## 6. Answer Generation ì „ëµ (LLM Prompting)

### í”„ë¡¬í”„íŠ¸ êµ¬ì¡°

```python
SYSTEM_PROMPT = """You are a CDP (Carbon Disclosure Project) disclosure expert.

CRITICAL RULES - YOU MUST FOLLOW:
1. Historical CDP answers are REFERENCE ONLY - DO NOT copy them directly
2. Remove any year-specific expressions (e.g., "In 2023" â†’ "Currently")
3. Use ONLY current year data from sustainability reports for facts/numbers
4. All numerical data must come from the current sustainability report

OUTPUT FORMAT:
- Respond in JSON format matching the provided schema
- Include rationale in both English and Korean
"""
```

### ì—­í•  ë¶„ë¦¬ í”„ë¡¬í”„íŠ¸

```python
# ê³¼ê±° ë‹µë³€ (ì°¸ê³ ìš©)
HISTORICAL_CONTEXT = """
âš ï¸ WARNING: The following are PAST CDP answers for REFERENCE ONLY.
DO NOT copy these directly. Use them ONLY for:
- Understanding the expected format/structure
- Identifying relevant topics to cover
- Learning the appropriate tone/style

{historical_answers}

âš ï¸ DO NOT use past numbers/metrics - use current sustainability report data
"""

# í˜„ì¬ ë³´ê³ ì„œ (ì‚¬ì‹¤ ê¸°ë°˜)
CURRENT_CONTEXT = """
âœ… The following is from the {year} Sustainability Report.
Use this as the PRIMARY and ONLY source for facts, numbers, and current policies.

{sustainability_content}

âœ… This is your authoritative source for current metrics and policies.
"""
```

---

## 7. ì‹ ë¢°ì„± í™•ë³´ ì¥ì¹˜ (Reliability & Evaluation)

### ì‹ ë¢°ë„ ê³„ì‚° ë¡œì§

```python
def calculate_confidence(has_historical, rag_scores, mapping_confidence):
    base_score = 0.4

    # í˜„ì¬ RAG ì ìˆ˜ (50%) - í•µì‹¬ ê°€ì¤‘ì¹˜
    if rag_scores:
        base_score += (sum(rag_scores) / len(rag_scores)) * 0.5

    # ê³¼ê±° ë‹µë³€ ìœ ë¬´ (10%) - ì°¸ê³ ìš©ì´ë¯€ë¡œ ë‚®ì€ ê°€ì¤‘ì¹˜
    if has_historical:
        base_score += 0.1

    # ë§¤í•‘ ì‹ ë¢°ë„ (10%)
    bonus = {"high": 0.1, "medium": 0.05, "low": 0.0}
    base_score += bonus.get(mapping_confidence, 0.0)

    return min(base_score, 0.95)
```

### ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

| ê²€ì¦ í•­ëª© | ë°©ë²• |
|----------|------|
| **ì—°ë„ ì¼ê´€ì„±** | ê²€ìƒ‰ ê²°ê³¼ì˜ year ë©”íƒ€ë°ì´í„° í™•ì¸ |
| **ì¶œì²˜ ëª…ì‹œ** | ëª¨ë“  ë‹µë³€ì— sources ë°°ì—´ í¬í•¨ |
| **ìˆ˜ì¹˜ ê·¼ê±°** | ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ í˜ì´ì§€ ë²ˆí˜¸ ì œê³µ |
| **í˜•ì‹ ì¤€ìˆ˜** | CDP ë¬¸í•­ì˜ columns ìŠ¤í‚¤ë§ˆ ê²€ì¦ |
| **ê³¼ê±° ë‹µë³€ ì—­í• ** | `is_primary: false`, `note: "Reference only"` í‘œì‹œ |

### ì‘ë‹µ ì˜ˆì‹œ

```json
{
  "question_id": "2.1",
  "rows": [
    {
      "columns": {
        "time_horizon": "Short-term",
        "from_years": 0,
        "to_years": 3,
        "description": "Our risk identification process covers..."
      }
    }
  ],
  "sources": [
    {
      "type": "sustainability_report",
      "year": 2025,
      "page_num": 45,
      "section": "risk_management",
      "score": 0.89,
      "is_primary": true
    },
    {
      "type": "cdp_historical",
      "year": 2024,
      "question_code": "2.1",
      "score": 0.76,
      "is_primary": false,
      "note": "Reference only - not used as source of facts"
    }
  ],
  "overall_confidence": 0.85,
  "rationale_en": "Based on SK Inc's 2025 Sustainability Report (p.45-47)...",
  "rationale_ko": "SK Incì˜ 2025ë…„ ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ(p.45-47)ì— ë”°ë¥´ë©´..."
}
```

---

## 8. ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

### Backend

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| Python | 3.11 | ëŸ°íƒ€ì„ |
| FastAPI | 0.109.0 | REST API ì„œë²„ |
| Pydantic | 2.5.3 | ë°ì´í„° ê²€ì¦ |
| Uvicorn | 0.27.0 | ASGI ì„œë²„ |

### AI/ML

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| OpenAI API | 1.6.1 | GPT-4o-mini LLM |
| BGE-M3 | External | ì„ë² ë”© + ë¦¬ë­í‚¹ |
| Qdrant | 1.7.0 | ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ |

### Document Processing

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| PyMuPDF | 1.23.8 | PDF íŒŒì‹± + í…Œì´ë¸” ì¶”ì¶œ |
| pdfplumber | 0.10.3 | PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ |

### Infrastructure

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| Docker | ì»¨í…Œì´ë„ˆí™” |
| httpx | ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸ |

---

## 9. í•œê³„ì™€ ê°œì„  ë°©í–¥ (Limitations & Future Work)

### í˜„ì¬ í•œê³„

| í•œê³„ | ì„¤ëª… |
|------|------|
| **ë¬¸í•­ ê°„ ì¶”ë¡  ë¶€ì¬** | Q2.1 ë‹µë³€ì´ Q2.2ì— ì˜í–¥ì„ ì£¼ëŠ” ê´€ê³„ë¥¼ ê³ ë ¤í•˜ì§€ ëª»í•¨ |
| **í…Œì´ë¸”/ì°¨íŠ¸ í•œê³„** | PDF ë‚´ ë³µì¡í•œ í…Œì´ë¸”ì€ ì •í™•í•œ ì¶”ì¶œì´ ì–´ë ¤ì›€ |
| **ë‹¨ì¼ ë¬¸ì„œ ì˜ì¡´** | ì—¬ëŸ¬ ë³´ê³ ì„œ ê°„ êµì°¨ ê²€ì¦ ë¯¸ì§€ì› |
| **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸** | ìƒˆ ë³´ê³ ì„œ ì¶”ê°€ ì‹œ ì „ì²´ ì¬ì¸ë±ì‹± í•„ìš” |

### í–¥í›„ ê°œì„  ê³„íš

```
1. Multi-hop RAG
   â†’ ë¬¸í•­ ê°„ ì°¸ì¡° ê´€ê³„ë¥¼ ê³ ë ¤í•œ ì—°ì‡„ ê²€ìƒ‰

2. Answer Scoring Model
   â†’ CDP ì±„ì  ê¸°ì¤€ ê¸°ë°˜ ìë™ ì ìˆ˜ ì˜ˆì¸¡

3. Table Extraction ê³ ë„í™”
   â†’ êµ¬ì¡°í™”ëœ í…Œì´ë¸” ë°ì´í„° ì „ìš© ì²­í‚¹

4. Feedback Loop
   â†’ ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ Retrieval í’ˆì§ˆ ê°œì„ 

5. Hybrid Search
   â†’ Dense + Sparse (BM25) ê²°í•© ê²€ìƒ‰
```

---

## 10. í”„ë¡œì íŠ¸ ê¸°ì—¬ (My Contribution)

| ì˜ì—­ | ê¸°ì—¬ ë‚´ìš© |
|------|----------|
| **ì•„í‚¤í…ì²˜ ì„¤ê³„** | 3-Layer (RAG â†’ Mapping â†’ Prompt) ì•„í‚¤í…ì²˜ ì„¤ê³„ |
| **ë°ì´í„° ëª¨ë¸ë§** | RAGDocument, Question Schema ì„¤ê³„ |
| **Retrieval ì „ëµ** | ë©”íƒ€ë°ì´í„° í•„í„°ë§ + ë¦¬ë­í‚¹ íŒŒì´í”„ë¼ì¸ êµ¬í˜„ |
| **í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§** | ì—­í•  ë¶„ë¦¬ í”„ë¡¬í”„íŠ¸ ê·œì¹™ ì •ì˜ |
| **ì‹ ë¢°ë„ ì„¤ê³„** | ê°€ì¤‘ì¹˜ ê¸°ë°˜ ì‹ ë¢°ë„ ê³„ì‚° ë¡œì§ êµ¬í˜„ |
| **PDF ì²˜ë¦¬** | ì‹œë§¨í‹± ì²­í‚¹ + ì„¹ì…˜ ë¶„ë¥˜ êµ¬í˜„ |

---

## 11. ë°ëª¨ / ê²°ê³¼ ì˜ˆì‹œ

### ìš”ì²­

```bash
curl -X POST "http://localhost:8000/ai/v1/generate/answer" \
  -H "Content-Type: application/json" \
  -d '{"question_id": "2.1"}'
```

### ì‘ë‹µ

```
Q. CDP 2.1: Describe your organization's time horizons for climate risk identification

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Answer:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Time Horizonâ”‚ From Years â”‚ To Years â”‚ Description                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Short-term  â”‚ 0          â”‚ 3        â”‚ Annual risk assessment...   â”‚
â”‚ Medium-term â”‚ 3          â”‚ 10       â”‚ Strategic planning cycle... â”‚
â”‚ Long-term   â”‚ 10         â”‚ 30       â”‚ Net-zero pathway analysis...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ Evidence:
  âœ… [PRIMARY] 2025 Sustainability Report, p.45-47, Section: Risk Management
  âš ï¸ [REF ONLY] 2024 CDP Response, Q2.1

ğŸ¯ Confidence: 85%

ğŸ’¬ Rationale:
  Based on SK Inc's 2025 Sustainability Report, the organization employs
  a three-tiered time horizon approach aligned with TCFD recommendations...
```

---

## 12. ì„¤ì¹˜ ë° ì‹¤í–‰

### í™˜ê²½ ì„¤ì •

```bash
# 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env

# .env íŒŒì¼ í¸ì§‘
OPENAI_API_KEY=sk-xxxxx
BGE_EMBEDDING_URL=http://localhost:5002
SPRING_API_URL=http://localhost:8080
```

### ì‹¤í–‰

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
cd backend
pip install -r requirements.txt

# ì„œë²„ ì‹¤í–‰
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### API ë¬¸ì„œ

- Swagger UI: http://localhost:8000/ai/v1/docs
- ReDoc: http://localhost:8000/ai/v1/redoc

---

## 13. API ì—”ë“œí¬ì¸íŠ¸

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/ai/v1/generate/answer` | ë‹¨ì¼ ì§ˆë¬¸ RAG ë‹µë³€ ìƒì„± |
| POST | `/ai/v1/generate/batch` | ì¼ê´„ ë‹µë³€ ìƒì„± |
| GET | `/ai/v1/questions` | ì „ì²´ ì§ˆë¬¸ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ |
| GET | `/ai/v1/questions/{id}` | íŠ¹ì • ì§ˆë¬¸ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ |
| GET | `/ai/v1/questionnaire` | CDP ì§ˆë¬¸ + ê°€ì´ë“œë¼ì¸ ì¡°íšŒ |
| POST | `/ai/v1/upload/sustainability-report` | ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œ ì¸ë±ì‹± |
| POST | `/ai/v1/upload/cdp-response` | ê³¼ê±° CDP ì‘ë‹µ ì¸ë±ì‹± |
| GET | `/ai/v1/health` | í—¬ìŠ¤ì²´í¬ |

---

## License

This project is proprietary software. All rights reserved.
